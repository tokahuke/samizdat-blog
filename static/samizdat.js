(()=>{"use strict";var t=function(t,e,n,r){return new(n||(n=Promise))((function(s,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,u)}c((r=r.apply(t,e||[])).next())}))},e=function(t,e){var n,r,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function n(n,r,s){return t(this,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return[4,fetch("http://localhost:4510"+r,{method:n,headers:{"Content-Type":"application/json"},body:s?JSON.stringify(s):void 0})];case 1:return[2,t.sent()]}}))}))}function r(n,r,s){return t(this,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return[4,fetch("http://localhost:4510"+r,{method:n,body:s})];case 1:return[2,t.sent()]}}))}))}var s=function(t,e,n,r){return new(n||(n=Promise))((function(s,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,u)}c((r=r.apply(t,e||[])).next())}))},i=function(t,e){var n,r,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function o(t){return s(this,void 0,void 0,(function(){var e,n,r,s,o;return i(this,(function(i){switch(i.label){case 0:return[4,fetch("/_auth/_current")];case 1:return 200!=(e=i.sent()).status?[3,3]:[4,e.json()];case 2:for(n=i.sent(),r=0,s=t;r<s.length;r++)if(o=s[r],!n.includes(o))return[2,!1];return[2,!0];case 3:return[2,!1]}}))}))}function u(){return s(this,void 0,void 0,(function(){var t,e,n,r,s;return i(this,(function(i){switch(i.label){case 0:if(t=window.screen,e={width:t.width/4,height:2*t.height/3},n=e.width,r=e.height,!(s=window.open("http://localhost:4510/_register?right=ManageSeries&right=ManageObjects","RegisterApp","\n      left="+(t.width-n)/2+",\n      top="+(t.height-r)/4+",\n      width="+n+",\n      height="+r+"\n    ")))throw new Error("Could not open authentication window");return[4,new Promise((function(t){s.addEventListener("auth",(function(e){return t(e)}))}))];case 1:switch(i.sent().detail.status){case"canceled":throw new Error("User canceled authentication flow");case"fail":throw new Error("Authentication flow failed");case"success":return[2]}return[2]}}))}))}function c(t){return s(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,o(t)];case 1:return e.sent()?[3,3]:[4,u()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))}var a,l,h=function(t,e,n,r){return new(n||(n=Promise))((function(s,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,u)}c((r=r.apply(t,e||[])).next())}))},f=function(t,e){var n,r,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};!function(t){t.ManageObjects="ManageObjects",t.GetObjectStats="GetObjectStats",t.ManageBookmarks="ManageBookmarks",t.ManageCollections="ManageCollections",t.ManageSeries="ManageSeries",t.ManageSubscriptions="ManageSubscriptions"}(a||(a={})),function(t){t.FullInventory="FullInventory"}(l||(l={}));var p=function(){function t(t){this.accessRights=t,this.isAuthenticated=!1,this.kvstore=new d}return t.prototype.authenticate=function(){return h(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return this.isAuthenticated?[3,2]:[4,c(this.accessRights)];case 1:t.sent(),this.isAuthenticated=!0,t.label=2;case 2:return[2]}}))}))},t.prototype._ensureRights=function(t){return h(this,void 0,void 0,(function(){var e,n,r;return f(this,(function(s){switch(s.label){case 0:e=0,n=this.accessRights,s.label=1;case 1:return e<n.length?(r=n[e],t.includes(r)?[4,this.authenticate()]:[3,3]):[3,4];case 2:return s.sent(),[2];case 3:return e++,[3,1];case 4:throw new Error("Current scope needs any of "+t+" but only has "+this.accessRights)}}))}))},t.prototype.getObject=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,n("GET","/_objects/"+t)];case 1:return[4,e.sent().blob()];case 2:return[2,e.sent()]}}))}))},t.prototype.postObject=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this._ensureRights([a.ManageObjects])];case 1:return e.sent(),[4,r("POST","/_objects",t)];case 2:return[4,e.sent().text()];case 3:return[2,e.sent()]}}))}))},t.prototype.deleteObject=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this._ensureRights([a.ManageObjects])];case 1:return e.sent(),[4,n("DELETE","/_objects/"+t)];case 2:return[2,e.sent().status<300]}}))}))},t.prototype.reissue=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this._ensureRights([a.ManageObjects])];case 1:return e.sent(),[4,n("POST","/_objects/"+t+"/reissue")];case 2:return[4,e.sent().text()];case 3:return[2,e.sent()]}}))}))},t.prototype.bookmark=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this._ensureRights([a.ManageBookmarks])];case 1:return e.sent(),[4,n("POST","/_objects/"+t+"/bookmark")];case 2:return[4,e.sent().json()];case 3:return[2,e.sent().Ok]}}))}))},t.prototype.isBookmarked=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this._ensureRights([a.ManageBookmarks])];case 1:return e.sent(),[4,n("GET","/_objects/"+t+"/bookmark")];case 2:return[4,e.sent().json()];case 3:return[2,e.sent().Ok]}}))}))},t.prototype.unbookmark=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this._ensureRights([a.ManageBookmarks])];case 1:return e.sent(),[4,n("DELETE","/_objects/"+t+"/bookmark")];case 2:return[4,e.sent().json()];case 3:return[2,e.sent().Ok]}}))}))},t.prototype.getStats=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this._ensureRights([a.GetObjectStats])];case 1:return e.sent(),[4,n("DELETE","/_objects/"+t+"/stats")];case 2:return[4,e.sent().json()];case 3:return[2,e.sent().Ok]}}))}))},t.prototype.getByteUsefulness=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this._ensureRights([a.GetObjectStats])];case 1:return e.sent(),[4,n("DELETE","/_objects/"+t+"/stats/byte-usefulness")];case 2:return[4,e.sent().json()];case 3:return[2,e.sent().Ok]}}))}))},t.prototype.postCollection=function(t,e){return void 0===e&&(e=!1),h(this,void 0,void 0,(function(){return f(this,(function(r){switch(r.label){case 0:return[4,this._ensureRights([a.ManageCollections])];case 1:return r.sent(),[4,n("POST","/_collections",{hashes:t,is_draft:e})];case 2:return[4,r.sent().text()];case 3:return[2,r.sent()]}}))}))},t.prototype.getItem=function(t,e){return h(this,void 0,void 0,(function(){return f(this,(function(r){switch(r.label){case 0:return[4,n("GET","/_collections"+t+e)];case 1:return[4,r.sent().blob()];case 2:return[2,r.sent()]}}))}))},t.prototype.getSeriesOwner=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this._ensureRights([a.ManageSeries])];case 1:return e.sent(),[4,n("GET","/_seriesowner/"+t)];case 2:return[4,e.sent().json()];case 3:return[2,e.sent().Ok]}}))}))},t.prototype.deleteSeriesOwner=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this._ensureRights([a.ManageSeries])];case 1:return e.sent(),[4,n("DELETEs","/_seriesowner/"+t)];case 2:return[4,e.sent().json()];case 3:return[2,e.sent().Ok]}}))}))},t.prototype.getSeriesOwners=function(){return h(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,this._ensureRights([a.ManageSeries])];case 1:return t.sent(),[4,n("GET","/_seriesowner")];case 2:return[4,t.sent().json()];case 3:return[2,t.sent().Ok]}}))}))},t.prototype.postEdition=function(t,e,r,s){return void 0===r&&(r=null),void 0===s&&(s=!1),h(this,void 0,void 0,(function(){return f(this,(function(i){switch(i.label){case 0:return[4,this._ensureRights([a.ManageSeries])];case 1:return i.sent(),[4,n("POST","/_seriesowner/"+t+"/editions",{collection:e,ttl:r,no_announce:s})];case 2:return[4,i.sent().json()];case 3:return[2,i.sent().Ok]}}))}))},t.prototype.getSeriesItem=function(t,e){return h(this,void 0,void 0,(function(){return f(this,(function(r){switch(r.label){case 0:return[4,n("GET","/_series"+t+e)];case 1:return[4,r.sent().blob()];case 2:return[2,r.sent()]}}))}))},t.prototype.getSubscription=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,n("GET","/_subscriptions"+t)];case 1:return[4,e.sent().json()];case 2:return[2,e.sent().Ok]}}))}))},t.prototype.postSubscription=function(t,e){return void 0===e&&(e=l.FullInventory),h(this,void 0,void 0,(function(){return f(this,(function(r){switch(r.label){case 0:return[4,n("POST","/_subscriptions",{series_key:t,kind:e})];case 1:return[4,r.sent().json()];case 2:return[2,r.sent().Ok]}}))}))},t.prototype.deleteSubscription=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,n("DELETE","/_subscriptions"+t)];case 1:return[4,e.sent().json()];case 2:return[2,e.sent().Ok]}}))}))},t}(),d=function(){function t(){}return t.prototype.get=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,n("GET","/_kvstore/"+t)];case 1:return[4,e.sent().json()];case 2:return[2,e.sent().Ok]}}))}))},t.prototype.put=function(t,e){return h(this,void 0,void 0,(function(){return f(this,(function(r){switch(r.label){case 0:return[4,n("PUT","/_kvstore/"+t,{value:e})];case 1:return[4,r.sent().json()];case 2:return[2,r.sent().Ok]}}))}))},t.prototype.delete=function(t){return h(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,n("DELETE","/_kvstore/"+t)];case 1:return[4,e.sent().json()];case 2:return[2,e.sent().Ok]}}))}))},t.prototype.clear=function(){return h(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,n("DELETE","/_kvstore")];case 1:return[4,t.sent().json()];case 2:return[2,t.sent().Ok]}}))}))},t}();window.Samizdat=p})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQVEsU0FBMkIsWUFFdkMsRUF6S0EsR0EyS0EsYUFDRSxjQXFCRixPQW5CUSxZQUFBa0UsSUFBTixTQUFVQyxHLDBGQUNTLFNBQU1sRixFQUFLLE1BQU8sYUFBYWtGLEksT0FDeEMsU0FEUyxTQUNNbkUsUSxPQUF2QixNQUFPLENBQVAsRUFBUSxTQUEyQixZQUcvQixZQUFBb0UsSUFBTixTQUFVRCxFQUFhRSxHLDBGQUNKLFNBQU1wRixFQUFLLE1BQU8sYUFBYWtGLEVBQU8sQ0FBRUUsTUFBSyxLLE9BQ3RELFNBRFMsU0FDTXJFLFEsT0FBdkIsTUFBTyxDQUFQLEVBQVEsU0FBMkIsWUFHL0IsWUFBQXNFLE9BQU4sU0FBYUgsRywwRkFDTSxTQUFNbEYsRUFBSyxTQUFVLGFBQWFrRixJLE9BQzNDLFNBRFMsU0FDTW5FLFEsT0FBdkIsTUFBTyxDQUFQLEVBQVEsU0FBMkIsWUFHL0IsWUFBQXVFLE1BQU4sVywwRkFDbUIsU0FBTXRGLEVBQUssU0FBVSxjLE9BQzlCLFNBRFMsU0FDTWUsUSxPQUF2QixNQUFPLENBQVAsRUFBUSxTQUEyQixZQUV2QyxFQXRCQSxHQThCQU0sT0FBT2tFLFNBQVdBLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYW1pemRhdGpzLy4vc3JjL2FwaS50cyIsIndlYnBhY2s6Ly9zYW1pemRhdGpzLy4vc3JjL2F1dGgudHMiLCJ3ZWJwYWNrOi8vc2FtaXpkYXRqcy8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgYXN5bmMgZnVuY3Rpb24gY2FsbChtZXRob2Q6IHN0cmluZywgcm91dGU6IHN0cmluZywgcGF5bG9hZD86IE9iamVjdCkge1xuICByZXR1cm4gYXdhaXQgZmV0Y2goYGh0dHA6Ly9sb2NhbGhvc3Q6NDUxMCR7cm91dGV9YCwge1xuICAgIG1ldGhvZCxcbiAgICBoZWFkZXJzOiB7XG4gICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICB9LFxuICAgIGJvZHk6IHBheWxvYWQgPyBKU09OLnN0cmluZ2lmeShwYXlsb2FkKSA6IHVuZGVmaW5lZCxcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYWxsUmF3KG1ldGhvZDogc3RyaW5nLCByb3V0ZTogc3RyaW5nLCBib2R5OiBCb2R5SW5pdCkge1xuICByZXR1cm4gYXdhaXQgZmV0Y2goYGh0dHA6Ly9sb2NhbGhvc3Q6NDUxMCR7cm91dGV9YCwge1xuICAgIG1ldGhvZCxcbiAgICBib2R5LFxuICB9KTtcbn1cbiIsImltcG9ydCB7IEFjY2Vzc1JpZ2h0IH0gZnJvbSBcIi4vaW5kZXhcIjtcblxuYXN5bmMgZnVuY3Rpb24gaXNBdXRoZW50aWNhdGVkKGFjY2Vzc1JpZ2h0czogQXJyYXk8QWNjZXNzUmlnaHQ+KSB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXCIvX2F1dGgvX2N1cnJlbnRcIik7XG5cbiAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDApIHtcbiAgICBjb25zdCBncmFudGVkUmlnaHRzOiBBcnJheTxBY2Nlc3NSaWdodD4gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgZm9yIChjb25zdCByaWdodCBvZiBhY2Nlc3NSaWdodHMpIHtcbiAgICAgIGlmICghZ3JhbnRlZFJpZ2h0cy5pbmNsdWRlcyhyaWdodCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5hc3luYyBmdW5jdGlvbiBkb0F1dGhlbnRpY2F0aW9uRmxvdygpIHtcbiAgaW50ZXJmYWNlIEF1dGhlbnRpY2F0aW9uRGV0YWlsIHtcbiAgICBzdGF0dXM6IFwic3VjY2Vzc1wiIHwgXCJmYWlsXCIgfCBcImNhbmNlbGVkXCI7XG4gIH1cblxuICBjb25zdCBzY3JlZW4gPSB3aW5kb3cuc2NyZWVuO1xuICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IHtcbiAgICB3aWR0aDogc2NyZWVuLndpZHRoIC8gNC4wLFxuICAgIGhlaWdodDogKHNjcmVlbi5oZWlnaHQgKiAyLjApIC8gMy4wLFxuICB9O1xuICBjb25zdCBhdXRoV2luZG93ID0gd2luZG93Lm9wZW4oXG4gICAgXCJodHRwOi8vbG9jYWxob3N0OjQ1MTAvX3JlZ2lzdGVyP3JpZ2h0PU1hbmFnZVNlcmllcyZyaWdodD1NYW5hZ2VPYmplY3RzXCIsXG4gICAgXCJSZWdpc3RlckFwcFwiLFxuICAgIGBcbiAgICAgIGxlZnQ9JHsoc2NyZWVuLndpZHRoIC0gd2lkdGgpIC8gMi4wfSxcbiAgICAgIHRvcD0keyhzY3JlZW4uaGVpZ2h0IC0gaGVpZ2h0KSAvIDQuMH0sXG4gICAgICB3aWR0aD0ke3dpZHRofSxcbiAgICAgIGhlaWdodD0ke2hlaWdodH1cbiAgICBgXG4gICk7XG5cbiAgaWYgKCFhdXRoV2luZG93KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IG9wZW4gYXV0aGVudGljYXRpb24gd2luZG93XCIpO1xuICB9XG5cbiAgY29uc3QgZXZlbnQgPSBhd2FpdCBuZXcgUHJvbWlzZTxDdXN0b21FdmVudDxBdXRoZW50aWNhdGlvbkRldGFpbD4+KFxuICAgIChyZXNvbHZlcikgPT4ge1xuICAgICAgYXV0aFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICBcImF1dGhcIixcbiAgICAgICAgKGU6IEN1c3RvbUV2ZW50PEF1dGhlbnRpY2F0aW9uRGV0YWlsPikgPT4gcmVzb2x2ZXIoZSlcbiAgICAgICk7XG4gICAgfVxuICApO1xuXG4gIHN3aXRjaCAoZXZlbnQuZGV0YWlsLnN0YXR1cykge1xuICAgIGNhc2UgXCJjYW5jZWxlZFwiOlxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlciBjYW5jZWxlZCBhdXRoZW50aWNhdGlvbiBmbG93XCIpO1xuICAgIGNhc2UgXCJmYWlsXCI6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBdXRoZW50aWNhdGlvbiBmbG93IGZhaWxlZFwiKTtcbiAgICBjYXNlIFwic3VjY2Vzc1wiOlxuICAgICAgcmV0dXJuO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdXRoZW50aWNhdGUoYWNjZXNzUmlnaHRzOiBBcnJheTxBY2Nlc3NSaWdodD4pIHtcbiAgaWYgKCEoYXdhaXQgaXNBdXRoZW50aWNhdGVkKGFjY2Vzc1JpZ2h0cykpKSB7XG4gICAgYXdhaXQgZG9BdXRoZW50aWNhdGlvbkZsb3coKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgY2FsbCwgY2FsbFJhdyB9IGZyb20gXCIuL2FwaVwiO1xuaW1wb3J0IHsgYXV0aGVudGljYXRlIH0gZnJvbSBcIi4vYXV0aFwiO1xuXG5leHBvcnQgZW51bSBBY2Nlc3NSaWdodCB7XG4gIE1hbmFnZU9iamVjdHMgPSBcIk1hbmFnZU9iamVjdHNcIixcbiAgR2V0T2JqZWN0U3RhdHMgPSBcIkdldE9iamVjdFN0YXRzXCIsXG4gIE1hbmFnZUJvb2ttYXJrcyA9IFwiTWFuYWdlQm9va21hcmtzXCIsXG4gIE1hbmFnZUNvbGxlY3Rpb25zID0gXCJNYW5hZ2VDb2xsZWN0aW9uc1wiLFxuICBNYW5hZ2VTZXJpZXMgPSBcIk1hbmFnZVNlcmllc1wiLFxuICBNYW5hZ2VTdWJzY3JpcHRpb25zID0gXCJNYW5hZ2VTdWJzY3JpcHRpb25zXCIsXG59XG5cbi8qKlxuICogT3V0cHV0IGZyb20gQVBJLiBUaGVyZWZvcmUsIHNuYWtlX2Nhc2UuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgT2JqZWN0U3RhdHMge1xuICBzaXplOiBudW1iZXI7XG4gIGNyZWF0ZWRfYXQ6IHN0cmluZztcbiAgbGFzdF90b3VjaGVkX2F0OiBzdHJpbmc7XG4gIHRvdWNoZXM6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBPdXRwdXQgZnJvbSBBUEkuIFRoZXJlZm9yZSwgc25ha2VfY2FzZS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBLZXlwYWlyIHtcbiAgcHVibGljOiBBcnJheTxudW1iZXI+O1xuICBzZWNyZXQ6IEFycmF5PG51bWJlcj47XG59XG5cbi8qKlxuICogT3V0cHV0IGZyb20gQVBJLiBUaGVyZWZvcmUsIHNuYWtlX2Nhc2UuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU2VyaWVzT3duZXIge1xuICBuYW1lOiBzdHJpbmc7XG4gIGtleXBhaXI6IEtleXBhaXI7XG4gIGRlZmF1bHRfdHRsOiBzdHJpbmc7XG4gIGlzX2RyYWZ0OiBib29sZWFuO1xufVxuXG4vKipcbiAqIE91dHB1dCBmcm9tIEFQSS4gVGhlcmVmb3JlLCBzbmFrZV9jYXNlLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNpZ25lZDxUPiB7XG4gIGNvbnRlbnQ6IFQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRWRpdGlvbkNvbnRlbnQge1xuICBjb2xsZWN0aW9uOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogc3RyaW5nO1xuICB0dGw6IHN0cmluZztcbn1cblxuLyoqXG4gKiBPdXRwdXQgZnJvbSBBUEkuIFRoZXJlZm9yZSwgc25ha2VfY2FzZS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBFZGl0aW9uIHtcbiAgc2lnbmVkOiBTaWduZWQ8RWRpdGlvbkNvbnRlbnQ+O1xuICBwdWJsaWNfa2V5OiBzdHJpbmc7XG4gIGlzX2RyYWZ0OiBib29sZWFuO1xufVxuXG5leHBvcnQgZW51bSBTdWJzY3JpcHRpb25LaW5kIHtcbiAgRnVsbEludmVudG9yeSA9IFwiRnVsbEludmVudG9yeVwiXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3Vic2NyaXB0aW9uIHtcbiAgcHVibGljX2tleTogQXJyYXk8bnVtYmVyPixcbiAga2luZDogU3Vic2NyaXB0aW9uS2luZCwgXG59XG5cbmV4cG9ydCBjbGFzcyBTYW1pemRhdCB7XG4gIGFjY2Vzc1JpZ2h0czogQXJyYXk8QWNjZXNzUmlnaHQ+O1xuICBpc0F1dGhlbnRpY2F0ZWQ6IGJvb2xlYW47XG4gIGt2c3RvcmU6IEtWU3RvcmU7XG5cbiAgY29uc3RydWN0b3IoYWNjZXNzUmlnaHRzOiBBcnJheTxBY2Nlc3NSaWdodD4pIHtcbiAgICB0aGlzLmFjY2Vzc1JpZ2h0cyA9IGFjY2Vzc1JpZ2h0cztcbiAgICB0aGlzLmlzQXV0aGVudGljYXRlZCA9IGZhbHNlO1xuICAgIHRoaXMua3ZzdG9yZSA9IG5ldyBLVlN0b3JlKCk7XG4gIH1cblxuICAvKipcbiAgICogRXhwbGljaXRseSBhdXRoZW50aWNhdGVzIHRoaXMgY29udGV4dCB0byB0aGUgY3VycmVudCBTYW1pemRhdCBub2RlLlxuICAgKiBBdXRoZW50aWNhdGlvbiBpcyBkb25lIGF1dG9tYXRpY2FsbHkgd2hlbiB1c2luZyB0aGlzIG9iamVjdC5cbiAgICovXG4gIGFzeW5jIGF1dGhlbnRpY2F0ZSgpIHtcbiAgICBpZiAoIXRoaXMuaXNBdXRoZW50aWNhdGVkKSB7XG4gICAgICBhd2FpdCBhdXRoZW50aWNhdGUodGhpcy5hY2Nlc3NSaWdodHMpO1xuICAgICAgdGhpcy5pc0F1dGhlbnRpY2F0ZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIF9lbnN1cmVSaWdodHMobmVjZXNzYXJ5UmlnaHRzOiBBcnJheTxBY2Nlc3NSaWdodD4pIHtcbiAgICBmb3IgKGNvbnN0IHJpZ2h0IG9mIHRoaXMuYWNjZXNzUmlnaHRzKSB7XG4gICAgICBpZiAobmVjZXNzYXJ5UmlnaHRzLmluY2x1ZGVzKHJpZ2h0KSkge1xuICAgICAgICBhd2FpdCB0aGlzLmF1dGhlbnRpY2F0ZSgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYEN1cnJlbnQgc2NvcGUgbmVlZHMgYW55IG9mICR7bmVjZXNzYXJ5UmlnaHRzfSBidXQgb25seSBoYXMgJHt0aGlzLmFjY2Vzc1JpZ2h0c31gXG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIGdldE9iamVjdChvYmplY3Q6IHN0cmluZykge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FsbChcIkdFVFwiLCBgL19vYmplY3RzLyR7b2JqZWN0fWApO1xuICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5ibG9iKCk7XG4gIH1cblxuICBhc3luYyBwb3N0T2JqZWN0KGNvbnRlbnQ6IEJvZHlJbml0KSB7XG4gICAgYXdhaXQgdGhpcy5fZW5zdXJlUmlnaHRzKFtBY2Nlc3NSaWdodC5NYW5hZ2VPYmplY3RzXSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjYWxsUmF3KFwiUE9TVFwiLCBgL19vYmplY3RzYCwgY29udGVudCk7XG4gICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZU9iamVjdChvYmplY3Q6IHN0cmluZykge1xuICAgIGF3YWl0IHRoaXMuX2Vuc3VyZVJpZ2h0cyhbQWNjZXNzUmlnaHQuTWFuYWdlT2JqZWN0c10pO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FsbChcIkRFTEVURVwiLCBgL19vYmplY3RzLyR7b2JqZWN0fWApO1xuICAgIHJldHVybiByZXNwb25zZS5zdGF0dXMgPCAzMDA7XG4gIH1cblxuICBhc3luYyByZWlzc3VlKG9iamVjdDogc3RyaW5nKSB7XG4gICAgYXdhaXQgdGhpcy5fZW5zdXJlUmlnaHRzKFtBY2Nlc3NSaWdodC5NYW5hZ2VPYmplY3RzXSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjYWxsKFwiUE9TVFwiLCBgL19vYmplY3RzLyR7b2JqZWN0fS9yZWlzc3VlYCk7XG4gICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgfVxuXG4gIGFzeW5jIGJvb2ttYXJrKG9iamVjdDogc3RyaW5nKSB7XG4gICAgYXdhaXQgdGhpcy5fZW5zdXJlUmlnaHRzKFtBY2Nlc3NSaWdodC5NYW5hZ2VCb29rbWFya3NdKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJQT1NUXCIsIGAvX29iamVjdHMvJHtvYmplY3R9L2Jvb2ttYXJrYCk7XG4gICAgcmV0dXJuIChhd2FpdCByZXNwb25zZS5qc29uKCkpW1wiT2tcIl0gYXMgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGlzQm9va21hcmtlZChvYmplY3Q6IHN0cmluZykge1xuICAgIGF3YWl0IHRoaXMuX2Vuc3VyZVJpZ2h0cyhbQWNjZXNzUmlnaHQuTWFuYWdlQm9va21hcmtzXSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjYWxsKFwiR0VUXCIsIGAvX29iamVjdHMvJHtvYmplY3R9L2Jvb2ttYXJrYCk7XG4gICAgcmV0dXJuIChhd2FpdCByZXNwb25zZS5qc29uKCkpW1wiT2tcIl0gYXMgYm9vbGVhbjtcbiAgfVxuXG4gIGFzeW5jIHVuYm9va21hcmsob2JqZWN0OiBzdHJpbmcpIHtcbiAgICBhd2FpdCB0aGlzLl9lbnN1cmVSaWdodHMoW0FjY2Vzc1JpZ2h0Lk1hbmFnZUJvb2ttYXJrc10pO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FsbChcIkRFTEVURVwiLCBgL19vYmplY3RzLyR7b2JqZWN0fS9ib29rbWFya2ApO1xuICAgIHJldHVybiAoYXdhaXQgcmVzcG9uc2UuanNvbigpKVtcIk9rXCJdIGFzIG51bGw7XG4gIH1cblxuICBhc3luYyBnZXRTdGF0cyhvYmplY3Q6IHN0cmluZykge1xuICAgIGF3YWl0IHRoaXMuX2Vuc3VyZVJpZ2h0cyhbQWNjZXNzUmlnaHQuR2V0T2JqZWN0U3RhdHNdKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJERUxFVEVcIiwgYC9fb2JqZWN0cy8ke29iamVjdH0vc3RhdHNgKTtcbiAgICByZXR1cm4gKGF3YWl0IHJlc3BvbnNlLmpzb24oKSlbXCJPa1wiXSBhcyBPYmplY3RTdGF0cyB8IG51bGw7XG4gIH1cblxuICBhc3luYyBnZXRCeXRlVXNlZnVsbmVzcyhvYmplY3Q6IHN0cmluZykge1xuICAgIGF3YWl0IHRoaXMuX2Vuc3VyZVJpZ2h0cyhbQWNjZXNzUmlnaHQuR2V0T2JqZWN0U3RhdHNdKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXG4gICAgICBcIkRFTEVURVwiLFxuICAgICAgYC9fb2JqZWN0cy8ke29iamVjdH0vc3RhdHMvYnl0ZS11c2VmdWxuZXNzYFxuICAgICk7XG4gICAgcmV0dXJuIChhd2FpdCByZXNwb25zZS5qc29uKCkpW1wiT2tcIl0gYXMgbnVtYmVyIHwgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIHBvc3RDb2xsZWN0aW9uKFxuICAgIGhhc2hlczogQXJyYXk8W3N0cmluZywgc3RyaW5nXT4sXG4gICAgaXNEcmFmdDogYm9vbGVhbiA9IGZhbHNlXG4gICkge1xuICAgIGF3YWl0IHRoaXMuX2Vuc3VyZVJpZ2h0cyhbQWNjZXNzUmlnaHQuTWFuYWdlQ29sbGVjdGlvbnNdKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJQT1NUXCIsIGAvX2NvbGxlY3Rpb25zYCwge1xuICAgICAgaGFzaGVzLFxuICAgICAgaXNfZHJhZnQ6IGlzRHJhZnQsXG4gICAgfSk7XG4gICAgcmV0dXJuIGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgfVxuXG4gIGFzeW5jIGdldEl0ZW0oY29sbGVjdGlvbjogc3RyaW5nLCBwYXRoOiBzdHJpbmcpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJHRVRcIiwgYC9fY29sbGVjdGlvbnMke2NvbGxlY3Rpb259JHtwYXRofWApO1xuICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5ibG9iKCk7XG4gIH1cblxuICAvLyBUT0RPOiBmaW5kIGEgZ29vZCBFRDI1NTE5IEpTIGxpYnJhcnkgdG8gZ2VuZXJhdGUga2V5cGFpcnMuXG4gIC8vIGFzeW5jIHBvc3RTZXJpZXNPd25lcigpIHtcbiAgLy8gICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJHRVRcIiwgYC9fc2VyaWVzb3duZXJzYCk7XG4gIC8vIH1cblxuICBhc3luYyBnZXRTZXJpZXNPd25lcihzZXJpZXNPd25lcjogc3RyaW5nKSB7XG4gICAgYXdhaXQgdGhpcy5fZW5zdXJlUmlnaHRzKFtBY2Nlc3NSaWdodC5NYW5hZ2VTZXJpZXNdKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJHRVRcIiwgYC9fc2VyaWVzb3duZXIvJHtzZXJpZXNPd25lcn1gKTtcbiAgICByZXR1cm4gKGF3YWl0IHJlc3BvbnNlLmpzb24oKSlbXCJPa1wiXSBhcyBTZXJpZXNPd25lciB8IG51bGw7XG4gIH1cblxuICBhc3luYyBkZWxldGVTZXJpZXNPd25lcihzZXJpZXNPd25lcjogc3RyaW5nKSB7XG4gICAgYXdhaXQgdGhpcy5fZW5zdXJlUmlnaHRzKFtBY2Nlc3NSaWdodC5NYW5hZ2VTZXJpZXNdKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJERUxFVEVzXCIsIGAvX3Nlcmllc293bmVyLyR7c2VyaWVzT3duZXJ9YCk7XG4gICAgcmV0dXJuIChhd2FpdCByZXNwb25zZS5qc29uKCkpW1wiT2tcIl0gYXMgYm9vbGVhbjtcbiAgfVxuXG4gIGFzeW5jIGdldFNlcmllc093bmVycygpIHtcbiAgICBhd2FpdCB0aGlzLl9lbnN1cmVSaWdodHMoW0FjY2Vzc1JpZ2h0Lk1hbmFnZVNlcmllc10pO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FsbChcIkdFVFwiLCBgL19zZXJpZXNvd25lcmApO1xuICAgIHJldHVybiAoYXdhaXQgcmVzcG9uc2UuanNvbigpKVtcIk9rXCJdIGFzIEFycmF5PFNlcmllc093bmVyPjtcbiAgfVxuXG4gIGFzeW5jIHBvc3RFZGl0aW9uKFxuICAgIHNlcmllc093bmVyOiBzdHJpbmcsXG4gICAgY29sbGVjdGlvbjogc3RyaW5nLFxuICAgIHR0bDogc3RyaW5nIHwgbnVsbCA9IG51bGwsXG4gICAgbm9Bbm5vdW5jZTogYm9vbGVhbiA9IGZhbHNlXG4gICkge1xuICAgIGF3YWl0IHRoaXMuX2Vuc3VyZVJpZ2h0cyhbQWNjZXNzUmlnaHQuTWFuYWdlU2VyaWVzXSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjYWxsKFxuICAgICAgXCJQT1NUXCIsXG4gICAgICBgL19zZXJpZXNvd25lci8ke3Nlcmllc093bmVyfS9lZGl0aW9uc2AsXG4gICAgICB7XG4gICAgICAgIGNvbGxlY3Rpb24sXG4gICAgICAgIHR0bCxcbiAgICAgICAgbm9fYW5ub3VuY2U6IG5vQW5ub3VuY2UsXG4gICAgICB9XG4gICAgKTtcbiAgICByZXR1cm4gKGF3YWl0IHJlc3BvbnNlLmpzb24oKSlbXCJPa1wiXSBhcyBBcnJheTxTZXJpZXNPd25lcj47XG4gIH1cblxuICBhc3luYyBnZXRTZXJpZXNJdGVtKHNlcmllc0tleTogc3RyaW5nLCBwYXRoOiBzdHJpbmcpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJHRVRcIiwgYC9fc2VyaWVzJHtzZXJpZXNLZXl9JHtwYXRofWApO1xuICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5ibG9iKCk7XG4gIH1cblxuICBhc3luYyBnZXRTdWJzY3JpcHRpb24oc2VyaWVzS2V5OiBzdHJpbmcpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJHRVRcIiwgYC9fc3Vic2NyaXB0aW9ucyR7c2VyaWVzS2V5fWApO1xuICAgIHJldHVybiAoYXdhaXQgcmVzcG9uc2UuanNvbigpKVtcIk9rXCJdIGFzIFN1YnNjcmlwdGlvbiB8IG51bGw7XG4gIH1cblxuICBhc3luYyBwb3N0U3Vic2NyaXB0aW9uKHNlcmllc0tleTogc3RyaW5nLCBraW5kOiBTdWJzY3JpcHRpb25LaW5kID0gU3Vic2NyaXB0aW9uS2luZC5GdWxsSW52ZW50b3J5KSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjYWxsKFwiUE9TVFwiLCBgL19zdWJzY3JpcHRpb25zYCwgeyBzZXJpZXNfa2V5OiBzZXJpZXNLZXksIGtpbmQgfSk7XG4gICAgcmV0dXJuIChhd2FpdCByZXNwb25zZS5qc29uKCkpW1wiT2tcIl0gYXMgc3RyaW5nO1xuICB9XG5cbiAgYXN5bmMgZGVsZXRlU3Vic2NyaXB0aW9uKHNlcmllc0tleTogc3RyaW5nKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjYWxsKFwiREVMRVRFXCIsIGAvX3N1YnNjcmlwdGlvbnMke3Nlcmllc0tleX1gKTtcbiAgICByZXR1cm4gKGF3YWl0IHJlc3BvbnNlLmpzb24oKSlbXCJPa1wiXSBhcyBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBLVlN0b3JlIHtcbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIGFzeW5jIGdldChrZXk6IHN0cmluZykge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FsbChcIkdFVFwiLCBgL19rdnN0b3JlLyR7a2V5fWApO1xuICAgIHJldHVybiAoYXdhaXQgcmVzcG9uc2UuanNvbigpKVtcIk9rXCJdIGFzIHN0cmluZyB8IG51bGw7XG4gIH1cblxuICBhc3luYyBwdXQoa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJQVVRcIiwgYC9fa3ZzdG9yZS8ke2tleX1gLCB7IHZhbHVlIH0pO1xuICAgIHJldHVybiAoYXdhaXQgcmVzcG9uc2UuanNvbigpKVtcIk9rXCJdIGFzIG51bGw7XG4gIH1cblxuICBhc3luYyBkZWxldGUoa2V5OiBzdHJpbmcpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGNhbGwoXCJERUxFVEVcIiwgYC9fa3ZzdG9yZS8ke2tleX1gKTtcbiAgICByZXR1cm4gKGF3YWl0IHJlc3BvbnNlLmpzb24oKSlbXCJPa1wiXSBhcyBudWxsO1xuICB9XG5cbiAgYXN5bmMgY2xlYXIoKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjYWxsKFwiREVMRVRFXCIsIGAvX2t2c3RvcmVgKTtcbiAgICByZXR1cm4gKGF3YWl0IHJlc3BvbnNlLmpzb24oKSlbXCJPa1wiXSBhcyBudWxsO1xuICB9XG59XG5cbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgU2FtaXpkYXQ6IGFueTtcbiAgfVxufVxuXG53aW5kb3cuU2FtaXpkYXQgPSBTYW1pemRhdDtcbiJdLCJuYW1lcyI6WyJjYWxsIiwibWV0aG9kIiwicm91dGUiLCJwYXlsb2FkIiwiZmV0Y2giLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1bmRlZmluZWQiLCJjYWxsUmF3IiwiaXNBdXRoZW50aWNhdGVkIiwiYWNjZXNzUmlnaHRzIiwicmVzcG9uc2UiLCJzdGF0dXMiLCJqc29uIiwiZ3JhbnRlZFJpZ2h0cyIsInJpZ2h0IiwiaW5jbHVkZXMiLCJkb0F1dGhlbnRpY2F0aW9uRmxvdyIsInNjcmVlbiIsIndpbmRvdyIsIndpZHRoIiwiaGVpZ2h0IiwiYXV0aFdpbmRvdyIsIm9wZW4iLCJFcnJvciIsIlByb21pc2UiLCJyZXNvbHZlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiZGV0YWlsIiwiYXV0aGVudGljYXRlIiwiQWNjZXNzUmlnaHQiLCJTdWJzY3JpcHRpb25LaW5kIiwidGhpcyIsImt2c3RvcmUiLCJLVlN0b3JlIiwiX2Vuc3VyZVJpZ2h0cyIsIm5lY2Vzc2FyeVJpZ2h0cyIsImdldE9iamVjdCIsIm9iamVjdCIsImJsb2IiLCJwb3N0T2JqZWN0IiwiY29udGVudCIsIk1hbmFnZU9iamVjdHMiLCJ0ZXh0IiwiZGVsZXRlT2JqZWN0IiwicmVpc3N1ZSIsImJvb2ttYXJrIiwiTWFuYWdlQm9va21hcmtzIiwiaXNCb29rbWFya2VkIiwidW5ib29rbWFyayIsImdldFN0YXRzIiwiR2V0T2JqZWN0U3RhdHMiLCJnZXRCeXRlVXNlZnVsbmVzcyIsInBvc3RDb2xsZWN0aW9uIiwiaGFzaGVzIiwiaXNEcmFmdCIsIk1hbmFnZUNvbGxlY3Rpb25zIiwiaXNfZHJhZnQiLCJnZXRJdGVtIiwiY29sbGVjdGlvbiIsInBhdGgiLCJnZXRTZXJpZXNPd25lciIsInNlcmllc093bmVyIiwiTWFuYWdlU2VyaWVzIiwiZGVsZXRlU2VyaWVzT3duZXIiLCJnZXRTZXJpZXNPd25lcnMiLCJwb3N0RWRpdGlvbiIsInR0bCIsIm5vQW5ub3VuY2UiLCJub19hbm5vdW5jZSIsImdldFNlcmllc0l0ZW0iLCJzZXJpZXNLZXkiLCJnZXRTdWJzY3JpcHRpb24iLCJwb3N0U3Vic2NyaXB0aW9uIiwia2luZCIsIkZ1bGxJbnZlbnRvcnkiLCJzZXJpZXNfa2V5IiwiZGVsZXRlU3Vic2NyaXB0aW9uIiwiZ2V0Iiwia2V5IiwicHV0IiwidmFsdWUiLCJkZWxldGUiLCJjbGVhciIsIlNhbWl6ZGF0Il0sInNvdXJjZVJvb3QiOiIifQ==